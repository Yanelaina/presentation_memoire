<!-- ====================================================================
     SECTION M√âTHODOLOGIE
     12 slides couvrant: Architecture ‚Üí Solveur Richards ‚Üí Couplage ‚Üí Extraction
     ==================================================================== -->

<!-- SLIDE M0: Page de Transition "M√âTHODOLOGIE" -->
<section data-background-gradient="linear-gradient(135deg, #2C3E50 0%, #4A5568 50%, #718096 100%)">
    <div style="text-align: center; padding: 100px 0;">
        <div style="font-size: 5em; margin-top: 40px; filter: drop-shadow(0 4px 6px rgba(0,0,0,0.3));">‚öôÔ∏è</div>

        <h1 style="font-size: 3.5em; color: #FFFFFF; margin-bottom: 20px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">
            M√âTHODOLOGIE
        </h1>
        <p style="font-size: 1.4em; color: #E2E8F0; font-style: italic; margin-bottom: 40px; text-shadow: 1px 1px 2px rgba(0,0,0,0.2);">
            Du concept √† l'impl√©mentation
        </p>
    </div>

    <aside class="notes">
        Passons maintenant √† la m√©thodologie. Je vais vous pr√©senter comment nous avons concr√®tement construit ce mod√®le coupl√©, depuis l'architecture g√©n√©rale jusqu'√† sa validation.
    </aside>
</section>

<!-- SLIDE M1: Architecture G√©n√©rale du Pipeline -->
<section data-background-color="#fbfbfb">
    <h4 style="color: #0B3D5B; border-bottom: 3px solid #6B8E23; padding-bottom: 10px; margin-bottom: 0px;">
        Architecture g√©n√©rale du pipeline de simulation
    </h4>

    <p style="font-size: 0.5em; text-align: center; margin: 10px auto; max-width: 900px; color: #333;">
        Un syst√®me modulaire int√©grant extraction de donn√©es, physique du sol et mod√®le de culture
    </p>

    <div class="fragment fade-in" data-fragment-index="1" style="text-align: center; margin-top: 0px;">
        <img src="assets/global_architecture.png" 
             style="width: 68%; box-shadow: 0 6px 20px rgba(0,0,0,0.15); border-radius: 10px;" 
             alt="Architecture globale du pipeline">
    </div>

    <!-- <div class="fragment fade-up" data-fragment-index="2" 
         style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-top: 5px; font-size: 0.4em;"> -->
        
        <!-- Colonne Entr√©es -->
        <!-- <div style="background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); 
                    padding: 15px; border-radius: 8px; border-left: 4px solid #3b82f6;">
            <h6 style="color: #1e40af; margin-bottom: 10px; font-size: 0.8em;">üì• Entr√©es</h6>
            <ul style="margin: 0; padding-left: 20px; line-height: 1.6;">
                <li>Donn√©es ERA5-Land (m√©t√©o)</li>
                <li>SoilGrids (propri√©t√©s sol)</li>
                <li>Param√®tres culture</li>
                <li>Sc√©narios irrigation</li>
            </ul>
        </div> -->

        <!-- Colonne Modules -->
        <!-- <div style="background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%); 
                    padding: 15px; border-radius: 8px; border-left: 4px solid #10b981;">
            <h6 style="color: #065f46; margin-bottom: 10px; font-size: 0.8em;">‚öôÔ∏è Modules</h6>
            <ul style="margin: 0; padding-left: 20px; line-height: 1.6;">
                <li><strong>Solveur Richards 2D</strong></li>
                <li><strong>AquaCrop-OSPy</strong></li>
                <li><strong>Interface couplage</strong></li>
                <li>Maillage adaptatif</li>
            </ul>
        </div> -->

        <!-- Colonne Sorties -->
        <!-- <div style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); 
                    padding: 15px; border-radius: 8px; border-left: 4px solid #f59e0b;">
            <h6 style="color: #92400e; margin-bottom: 10px; font-size: 0.8em;">üì§ Sorties</h6>
            <ul style="margin: 0; padding-left: 20px; line-height: 1.6;">
                <li>Œ∏(r,z,t) ‚Äî Teneur en eau 2D</li>
                <li>Rendement et biomasse</li>
                <li>LAI et couverture</li>
                <li>Consommation d'eau</li>
            </ul>
        </div>
    </div> -->

    <aside class="notes">
        Voici l'architecture compl√®te de notre pipeline. Nous partons de donn√©es mondiales ERA5 et SoilGrids, qui sont pr√©trait√©es et inject√©es dans notre syst√®me de couplage bidirectionnel. Le c≈ìur du syst√®me est le solveur Richards 2D coupl√© avec AquaCrop. Les sorties nous donnent √† la fois l'√©tat hydrique complet du sol et les indicateurs agronomiques comme le rendement et le LAI. L'architecture est modulaire, ce qui facilite les tests et la maintenance.
    </aside>
</section>

<!-- SLIDE M2: Solveur Richards - Domaine et Conditions aux Limites -->
<section>
    <section data-background-color="#fbfbfb">
        <h4 style="color: #0B3D5B; border-bottom: 3px solid #6B8E23; padding-bottom: 10px; margin-bottom: 25px;">
            Solveur Richards 2D ‚Äî Domaine de simulation
        </h4>

        <div style="display: grid; grid-template-columns: 1.5fr 1fr; gap: 35px; align-items: start;">
            
            <!-- Colonne gauche: Image du domaine -->
            <div class="fragment fade-in" data-fragment-index="1">
                <img src="assets/domaine.png" 
                    style="width: 120%; box-shadow: 0 6px 20px rgba(0,0,0,0.12); border-radius: 10px;" 
                    alt="Domaine axisym√©trique Richards">
                <p style="font-size: 0.75em; margin-top: 12px; color: #666; text-align: center; font-style: italic;">
                    <strong>Figure:</strong> Domaine axisym√©trique $(r,z)$ avec conditions aux limites
                </p>
            </div>

            <!-- Colonne droite: Sp√©cifications techniques -->
            <div style="text-align: left; font-size: 0.55em;">
                
                <!-- G√©om√©trie -->
                <div class="fragment fade-up" data-fragment-index="1" 
                    style="background: #dbeafe; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #3b82f6;">
                    <h6 style="color: #1e40af; margin-bottom: 10px; font-size: 1.15em;">üìê G√©om√©trie axisym√©trique</h6>
                    <ul style="margin: 0; padding-left: 20px; line-height: 1.8;">
                        <li><strong>Rayon:</strong> $R_{max} = 0.5 \text{‚Äì} 1.0 \ m$</li>
                        <li><strong>Profondeur:</strong> $Z_{max} = 1.0 \text{‚Äì} 1.5 \ m$</li>
                        <li><strong>Sym√©trie:</strong> Exploitation coordonn√©es cylindriques $(r,z)$</li>
                        <li><strong>Avantage:</strong> R√©duction 3D ‚Üí 2D</li>
                    </ul>
                </div>

                <!-- Conditions aux limites -->
                <div class="fragment fade-up" data-fragment-index="1" 
                    style="background: #fef3c7; padding: 15px; border-radius: 8px; border-left: 4px solid #f59e0b;">
                    <h6 style="color: #92400e; margin-bottom: 10px; font-size: 1.15em;">üîó Conditions aux limites</h6>
                    <ul style="margin: 0; padding-left: 20px; line-height: 1.8;">
                        <li>$\Gamma_{\text{surf}}^{\text{irr}} :$ Flux d‚Äôirrigation $q_{irr}(t)$</li>
                        <li>$\Gamma_{\text{surf}}^{\text{atm}} :$ Flux atmosph√©rique $(P - ET)$</li>
                        <li>$\Gamma_{\text{axe}} :$ Sym√©trie $(\partial \psi / \partial r = 0)$</li>
                        <li>$\Gamma_{\text{lat}}, \ \Gamma_{\text{fond}} :$ Drainage libre ou flux nul</li>
                    </ul>                
                </div>

            </div>
        </div>

        <aside class="notes">
            Pour r√©soudre l'√©quation de Richards, nous utilisons un domaine axisym√©trique en coordonn√©es (r,z). Cette g√©om√©trie est parfaitement adapt√©e √† l'irrigation goutte-√†-goutte qui cr√©e un bulbe circulaire autour du goutteur. Les conditions aux limites sont cruciales : en surface, on impose le flux d'irrigation localis√© et les √©changes atmosph√©riques. Sur l'axe, la condition de sym√©trie. Et sur les bords lat√©raux et le fond, on peut avoir du drainage libre selon la configuration.
        </aside>
    </section>


    <!-- SLIDE M2v1: Formulation Variationnelle (Verticale) -->
    <section data-background-color="#fbfbfb">
        <h5 style="color: #0B3D5B; border-bottom: 2px solid #6B8E23; padding-bottom: 8px; margin-bottom: 20px;">
            Formulation faible et discr√©tisation
        </h5>

        <!-- Espace fonctionnel -->
        <div class="fragment fade-in" data-fragment-index="1" 
            style="background: #dbeafe; padding: 18px; border-radius: 10px; margin-bottom: 20px; border-left: 4px solid #3b82f6;">
            <p style="font-size: 0.65em; margin-bottom: 10px; color: #1e40af;">
                <strong>Espace fonctionnel (Sobolev pond√©r√©):</strong>
            </p>
            <div style="font-size: 0.8em; text-align: center;">
                \[ V := H^1_r(\Omega) = \left\{ v \in L^2_r(\Omega) \,\big|\, \nabla v \in [L^2_r(\Omega)]^2 \right\} \]
            </div>
            <p style="font-size: 0.6em; margin-top: 8px; color: #666; font-style: italic;">
                Espace de Sobolev pond√©r√© par r pour g√©om√©trie axisym√©trique
            </p>
        </div>

        <div class="fragment fade-up" data-fragment-index="2">
            <img src="assets/weak_formulation.png" style="width: 100%; box-shadow: 0 6px 20px rgba(0,0,0,0.12); border-radius: 10px;"
                alt="Domaine axisym√©trique Richards">
        </div>
        <!-- Formulation variationnelle -->
        <!-- <div class="fragment fade-up" data-fragment-index="2" 
            style="background: #fef3c7; padding: 18px; border-radius: 10px; margin-bottom: 20px; border: 3px solid #f59e0b;">
            <p style="font-size: 0.65em; margin-bottom: 10px; color: #92400e;">
                <strong>Probl√®me:</strong> Trouver œà(t) ‚àà V tel que ‚àÄv ‚àà V:
            </p>
            <div style="font-size: 0.75em; text-align: center; line-height: 2;">
                \[
                \int_\Omega C(\psi)\frac{\partial\psi}{\partial t} v \,r\,dr\,dz
                + \int_\Omega K(\psi) \nabla\psi \cdot \nabla v \,r\,dr\,dz
                + \int_\Omega K(\psi) \frac{\partial v}{\partial z} \,r\,dr\,dz
                = \int_\Omega S v \,r\,dr\,dz + \int_{\Gamma_{\text{surf}}} q_{\text{surf}} v \,r\,d\Gamma
                \]
            </div>
        </div> -->

        <!-- Interpr√©tation physique -->
        <!-- <div class="fragment fade-up" data-fragment-index="3" 
            style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; font-size: 0.58em;">
            
            <div style="background: #f0f9ff; padding: 12px; border-radius: 6px; border-left: 3px solid #3b82f6;">
                <strong style="color: #1e40af;">‚è±Ô∏è Terme capacitif:</strong><br>
                $C(\psi)\ \frac{\partial \psi}{\partial t}$ ‚Äî Accumulation d'eau
            </div>

            <div style="background: #fef3c7; padding: 12px; border-radius: 6px; border-left: 3px solid #f59e0b;">
                <strong style="color: #92400e;">üåä Terme diffusif:</strong><br>
                K(œà) ‚àáœà ‚Äî Diffusion capillaire
            </div>

            <div style="background: #d1fae5; padding: 12px; border-radius: 6px; border-left: 3px solid #10b981;">
                <strong style="color: #065f46;">‚¨áÔ∏è Terme gravitaire:</strong><br>
                K(œà) ‚àÇv/‚àÇz ‚Äî Drainage gravitaire
            </div>

            <div style="background: #fef2f2; padding: 12px; border-radius: 6px; border-left: 3px solid #ef4444;">
                <strong style="color: #991b1b;">üå± Terme source:</strong><br>
                S ‚Äî Extraction racinaire
            </div>
        </div> -->

        <aside class="notes">
            Math√©matiquement, on transforme l'EDP forte en formulation faible. On cherche la solution dans un espace de Sobolev pond√©r√© par r pour tenir compte de la g√©om√©trie axisym√©trique. L'√©quation variationnelle fait appara√Ætre quatre termes principaux : le terme capacitif qui repr√©sente l'accumulation d'eau, le terme diffusif qui capture la diffusion capillaire, le terme gravitaire, et les termes sources incluant l'extraction racinaire.
        </aside>
    </section>

    <!-- SLIDE M2v2: Maillage Adaptatif (Verticale avec Vid√©o) -->
    <section data-background-color="#fbfbfb">
        <h5 style="color: #0B3D5B; border-bottom: 2px solid #6B8E23; padding-bottom: 8px; margin-bottom: 20px;">
            Maillage adaptatif pour capture des gradients
        </h5>

        <!-- Vid√©o animation -->
        <div class="fragment fade-in" data-fragment-index="1" style="text-align: center; margin-bottom: 25px;">
            <video width="70%" controls autoplay loop muted style="border-radius: 10px; box-shadow: 0 6px 20px rgba(0,0,0,0.15);">
                <source src="assets/animations/mesh_comparison_animation.mp4" type="video/mp4">
                Votre navigateur ne supporte pas la vid√©o HTML5.
            </video>
            <p style="font-size: 0.55em; margin-top: 12px; color: #666; font-style: italic;">
                <strong>Animation:</strong> Comparaison maillage uniforme vs adaptatif
            </p>
        </div>

        <!-- Comparaison texte -->
        <div class="fragment fade-up" data-fragment-index="1" 
            style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px; font-size: 0.52em;">
            
            <!-- Maillage uniforme -->
            <div style="background: #fef2f2; padding: 18px; border-radius: 8px; border-left: 4px solid #ef4444;">
                <h6 style="color: #991b1b; margin-bottom: 10px; font-size: 0.9em;">‚ùå Maillage uniforme</h6>
                <ul style="margin: 0; padding-left: 20px; line-height: 1.8;">
                    <li>Simple √† g√©n√©rer</li>
                    <li>~50,000 √©l√©ments</li>
                    <li>Gradients mal captur√©s</li>
                    <li>Pr√©cision limit√©e</li>
                    <li>Co√ªt calcul √©lev√©</li>
                </ul>
            </div>

            <!-- Maillage adaptatif -->
            <div style="background: #d1fae5; padding: 18px; border-radius: 8px; border-left: 4px solid #10b981;">
                <h6 style="color: #065f46; margin-bottom: 10px; font-size: 0.9em;">‚úÖ Maillage adaptatif</h6>
                <ul style="margin: 0; padding-left: 20px; line-height: 1.8;">
                    <li>Raffinement local pr√®s goutteur</li>
                    <li>~15,000 √©l√©ments</li>
                    <li>Gradients bien captur√©s</li>
                    <li><strong>Pr√©cision 10√ó meilleure</strong></li>
                    <li><strong>Co√ªt r√©duit de 60%</strong></li>
                </ul>
            </div>
        <!-- </div> -->

        <!-- Image statique compl√©mentaire -->
        <!-- <div class="fragment fade-in" data-fragment-index="3" style="text-align: center; margin-top: 20px;">
            <img src="assets/maillage.png" 
                style="width: 55%; box-shadow: 0 4px 15px rgba(0,0,0,0.1); border-radius: 8px;" 
                alt="Zoom maillage adaptatif">
            <p style="font-size: 0.5em; margin-top: 8px; color: #666; font-style: italic;">
                <strong>Zoom:</strong> Raffinement intense dans la zone du bulbe d'humectation
            </p>
        </div> -->

        <aside class="notes">
            Le choix du maillage est crucial. Cette animation montre la diff√©rence entre un maillage uniforme et notre maillage adaptatif. On raffine fortement la zone proche du goutteur o√π les gradients de pression sont tr√®s forts. R√©sultat : on divise le nombre d'√©l√©ments par 3 tout en augmentant consid√©rablement la pr√©cision. C'est essentiel pour capturer correctement la formation du bulbe d'humectation.
        </aside>
    </section>

    <!-- SLIDE M2v3: Discr√©tisation Spatiale (Verticale) -->
    <section data-background-color="#fbfbfb">
        <h6 style="color: #0B3D5B; border-bottom: 2px solid #6B8E23; padding-bottom: 8px; margin-bottom: 20px; font-size: 1.0em;">
            M√©thode des √âl√©ments Finis ‚Äî Discr√©tisation spatiale
        </h6>

        <!-- Approximation de Galerkin -->
        <div class="fragment fade-in" data-fragment-index="1" 
            style="background: #d1fae5; padding: 10px; border-radius: 10px; margin-bottom: 20px; border-left: 4px solid #10b981;">
            <p style="font-size: 0.55em; margin-bottom: 10px; color: #065f46;">
                <strong>Approximation de Galerkin (√©l√©ments P1):</strong>
            </p>
            <div style="font-size: 0.7em; text-align: center;">
                \[ V_h \subset V, \quad \psi_h(r,z,t) = \sum_{j=1}^N \psi_j(t) \phi_j(r,z) \]
            </div>
            <p style="font-size: 0.5em; margin-top: 8px; color: #666; font-style: italic;">
                Fonctions de base $\phi_j$ : lin√©aires par morceaux sur chaque √©l√©ment triangulaire
            </p>
        </div>

        <!-- Syst√®me matriciel -->
        <div class="fragment fade-up" data-fragment-index="2" 
            style="background: #fef3c7; padding: 20px; border-radius: 10px; margin-bottom: 20px; border: 3px solid #f59e0b;">
            <p style="font-size: 0.6em; margin-bottom: 12px; color: #92400e; text-align: center;">
                <strong>Forme compacte du syst√®me matriciel:</strong>
            </p>
            <div style="font-size: 0.75em; text-align: center; line-height: 2.2;">
                \[
                \mathbf{M}(\boldsymbol{\psi}) \frac{d\boldsymbol{\psi}}{dt}
                + \mathbf{A}(\boldsymbol{\psi}) \boldsymbol{\psi}
                + \mathbf{g}(\boldsymbol{\psi})
                = \mathbf{f} + \mathbf{s}(\boldsymbol{\psi})
                \]
            </div>
            <div class="fragment fade-up" data-fragment-index="2"
                style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; font-size: 0.58em;">
            
                <div style="padding: 12px; border-radius: 6px;">
                    <strong style="color: #1e40af;">$M(\psi)$:</strong> Matrice de masse<br>
                    <span style="font-size: 0.95em; color: #666;">Terme capacitif $C(\psi) \frac{\partial \psi}{\partial t}$</span>
                </div>
            
                <div style="padding: 12px; border-radius: 6px;">
                    <strong style="color: #92400e;">$A(\psi)$:</strong> Matrice de rigidit√©<br>
                    <span style="font-size: 0.95em; color: #666;">Terme diffusif $K(\psi) \nabla \psi$</span>
                </div>
            
                <div style="padding: 12px; border-radius: 6px;">
                    <strong style="color: #065f46;">$g(\psi)$:</strong> Vecteur gravitaire<br>
                    <span style="font-size: 0.95em; color: #666;">Drainage $K(\psi) \frac{\partial}{\partial z}$</span>
                </div>
            
                <div style="padding: 12px; border-radius: 6px;">
                    <strong style="color: #991b1b;">$f, s(\psi)$:</strong> Termes sources<br>
                    <span style="font-size: 0.95em; color: #666;">Flux de bord + extraction racinaire</span>
                </div>
            </div>
        </div>

        <!-- Matrices et vecteurs -->


        <aside class="notes">
            On discr√©tise l'espace avec des √©l√©ments finis lin√©aires. La solution est approxim√©e par une combinaison de fonctions de base nodales. Cela transforme notre EDP en un syst√®me d'EDO matriciel. On retrouve la matrice de masse M qui repr√©sente l'accumulation, la matrice de rigidit√© A pour la diffusion, et les vecteurs pour la gravit√© et les sources.
        </aside>
    </section>

    <!-- SLIDE M2v4: Algorithme de R√©solution (Verticale avec Code) -->
    <section data-background-color="#fbfbfb">
        <h6 style="color: #0B3D5B; border-bottom: 2px solid #6B8E23; padding-bottom: 8px; margin-bottom: 20px; font-size: 1.0em;">
            Algorithme de r√©solution num√©rique
        </h6>

        <!-- Sch√©ma temporel -->
        <div class="fragment fade-in" data-fragment-index="1" 
            style="background: #fef2f2; padding: 5px; border-radius: 10px; margin-bottom: 20px; border: 3px solid #ef4444; max-width: 850px; margin-left: auto; margin-right: auto;">
            <p style="font-size: 0.58em; margin-bottom: 10px; color: #991b1b;">
                <strong>Sch√©ma temporel ‚Äî Euler implicite (A-stable):</strong>
            </p>
            <div style="font-size: 0.55em; text-align: center; line-height: 2;">
                \[
                \mathbf{R}(\boldsymbol{\psi}^{n+1}) = \mathbf{M}(\boldsymbol{\psi}^{n+1})
                \frac{\boldsymbol{\psi}^{n+1} - \boldsymbol{\psi}^n}{\Delta t}
                + \mathbf{A}(\boldsymbol{\psi}^{n+1})\boldsymbol{\psi}^{n+1} 
                + \mathbf{g}(\boldsymbol{\psi}^{n+1}) - \mathbf{f} - \mathbf{s}(\boldsymbol{\psi}^{n+1}) = \mathbf{0}
                \]
            </div>
        </div>

        <!-- Strat√©gie de lin√©arisation -->
        <!-- <div class="fragment fade-up" data-fragment-index="2" 
            style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; font-size: 0.6em; margin-bottom: 20px;">
            
            <div style="background: #dbeafe; padding: 15px; border-radius: 8px; border-left: 4px solid #3b82f6;">
                <h6 style="color: #1e40af; margin-bottom: 8px; font-size: 1.05em;">üîÑ M√©thode de Picard</h6>
                <ul style="margin: 0; padding-left: 18px; line-height: 1.6;">
                    <li>2‚Äì5 it√©rations initiales</li>
                    <li>Simple et robuste</li>
                    <li>Convergence lin√©aire</li>
                </ul>
            </div>

            <div style="background: #d1fae5; padding: 15px; border-radius: 8px; border-left: 4px solid #10b981;">
                <h6 style="color: #065f46; margin-bottom: 8px; font-size: 1.05em;">‚ö° Newton-Raphson</h6>
                <ul style="margin: 0; padding-left: 18px; line-height: 1.6;">
                    <li>Jacobien complet</li>
                    <li>Convergence quadratique</li>
                    <li>Pr√©cision finale stricte</li>
                </ul>
            </div>
        </div> -->

        <p class="fragment fade-left" data-fragment-index="2"
        style="color: #0B3D5B; padding-bottom: 2px; margin-bottom: 0px; font-size: 0.7em;">
            Strat√©gie de lin√©arisation
        </p>

        <!-- Pseudo-code -->
        <div class="fragment fade-up" data-fragment-index="2">
            <pre style="background: #f8f9fa; border-left: 4px solid #3b82f6; padding: 15px; border-radius: 8px; font-size: 0.35em; line-height: 1.5;"><code class="python" data-trim data-line-numbers="1-3,11-22">
    # Algorithme hybride Picard-Newton
    for n in range(N_timesteps):
        œà_k = œà_n  # Initialisation au pas pr√©c√©dent

        # Phase 1: Picard (2-5 it√©rations pour d√©grossir)
        for k in range(m_Picard):
            Assemble M(œà_k), A(œà_k), g(œà_k), s(œà_k)
            Solve: [M(œà_k)/Œît + A(œà_k)] œà_{k+1} = RHS(œà_k, œà_n)
            œà_k = œà_{k+1}

        # Phase 2: Newton-Raphson (convergence stricte)
        while ||R(œà_k)|| > tol:
            Compute Jacobian: J(œà_k) = ‚àÇR/‚àÇœà
            Solve: J(œà_k) Œ¥œà = -R(œà_k)
            œà_{k+1} = œà_k + Œª Œ¥œà  # damping Œª ‚àà [0.5, 1] si oscillations
            œà_k = œà_{k+1}

        œà_{n+1} = œà_k  # Solution converg√©e pour ce pas de temps

        # Adaptation pas de temps
        if convergence rapide: Œît ‚Üê min(1.5¬∑Œît, Œît_max)
        if convergence lente: Œît ‚Üê max(0.5¬∑Œît, Œît_min)
            </code></pre>
        </div>

        <aside class="notes">
            Pour r√©soudre le syst√®me non-lin√©aire √† chaque pas de temps, on utilise une strat√©gie hybride. D'abord quelques it√©rations de Picard pour d√©grossir, puis on bascule sur Newton-Raphson avec le Jacobien complet pour converger rapidement. Cette approche combine robustesse et efficacit√©. On utilise aussi un pas de temps adaptatif qui s'ajuste selon la vitesse de convergence.
        </aside>
    </section>

</section>

<!-- SLIDE M3: Wrapper AquaCrop-OSPy -->
<section data-background-color="#fbfbfb">
    <h6 style="color: #0B3D5B; border-bottom: 3px solid #6B8E23; padding-bottom: 10px; margin-bottom: 5px;">
        Interface avec AquaCrop via OSPy
    </h6>

    <!-- Diagramme de flux -->
    <div class="fragment fade-in" data-fragment-index="1" style="margin-bottom: 25px;">
        <svg viewBox="0 0 900 180" style="width: 90%; margin: 0 auto; display: block;">
            <!-- Bloc Configuration -->
            <rect x="20" y="30" width="240" height="120" rx="12" fill="#dbeafe" stroke="#3b82f6" stroke-width="3"/>
            <text x="140" y="60" text-anchor="middle" font-size="18" font-weight="bold" fill="#1e40af">üìã Configuration</text>
            <text x="140" y="85" text-anchor="middle" font-size="13" fill="#333">Param√®tres culture</text>
            <text x="140" y="105" text-anchor="middle" font-size="13" fill="#333">Propri√©t√©s sol</text>
            <text x="140" y="125" text-anchor="middle" font-size="13" fill="#333">Donn√©es m√©t√©o</text>
            
            <!-- Fl√®che 1 -->
            <path d="M 260 90 L 320 90" stroke="#6B8E23" stroke-width="3" fill="none" marker-end="url(#arrowhead1)"/>
            
            <!-- Bloc OSPy Engine -->
            <rect x="320" y="30" width="240" height="120" rx="12" fill="#d1fae5" stroke="#10b981" stroke-width="3"/>
            <text x="440" y="60" text-anchor="middle" font-size="18" font-weight="bold" fill="#065f46">‚öôÔ∏è OSPy Engine</text>
            <text x="440" y="85" text-anchor="middle" font-size="13" fill="#333">Ex√©cution AquaCrop</text>
            <text x="440" y="105" text-anchor="middle" font-size="13" fill="#333">Simulation batch</text>
            <text x="440" y="125" text-anchor="middle" font-size="13" fill="#333">Mode Python natif</text>
            
            <!-- Fl√®che 2 -->
            <path d="M 560 90 L 620 90" stroke="#6B8E23" stroke-width="3" fill="none" marker-end="url(#arrowhead2)"/>
            
            <!-- Bloc R√©cup√©ration -->
            <rect x="620" y="30" width="240" height="120" rx="12" fill="#fef3c7" stroke="#f59e0b" stroke-width="3"/>
            <text x="740" y="60" text-anchor="middle" font-size="18" font-weight="bold" fill="#92400e">üì§ R√©cup√©ration</text>
            <text x="740" y="85" text-anchor="middle" font-size="13" fill="#333">Biomasse, LAI</text>
            <text x="740" y="105" text-anchor="middle" font-size="13" fill="#333">Rendement</text>
            <text x="740" y="125" text-anchor="middle" font-size="13" fill="#333">Transpiration T<tspan baseline-shift="sub" font-size="10">r</tspan></text>
            
            <!-- D√©finitions des fl√®ches -->
            <defs>
                <marker id="arrowhead1" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#6B8E23" />
                </marker>
                <marker id="arrowhead2" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#6B8E23" />
                </marker>
            </defs>
        </svg>
    </div>

    <!-- Code Python simplifi√© -->
    <div class="fragment fade-up" data-fragment-index="1">
        <pre style="background: #f8f9fa; border-left: 4px solid #10b981; padding: 15px; border-radius: 8px; font-size: 0.5em; line-height: 1.4;"><code class="python" data-trim data-line-numbers>
from aquacrop import AquaCropModel, Soil, Crop, IrrigationManagement

# Configuration du mod√®le
model = AquaCropModel(
    sim_start_time='2020/04/01',
    sim_end_time='2020/08/31',
    weather_df=meteo_data,          # DataFrame m√©t√©o journalier
    soil=Soil('SandyLoam'),          # Type de sol
    crop=Crop('Maize', planting_date='04/05'),
    irrigation_management=IrrigationManagement(SMT=[50,100])  # Seuils irrigation
)

# Ex√©cution de la simulation
model.run_model()

# R√©cup√©ration des r√©sultats
results = model.get_simulation_results()
LAI = results['Canopy Cover'].values           # Indice foliaire
Biomass = results['Dry above ground biomass'].values  # Biomasse a√©rienne
Yield = results['Dry yield'].values            # Rendement
Tr = results['Tr'].values                      # Transpiration journali√®re
        </code></pre>
    </div>

    <!-- Avantages -->
    <div class="fragment fade-up" data-fragment-index="3" 
         style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; font-size: 0.6em; margin-top: 20px;">
        
        <div style="background: #d1fae5; padding: 12px; border-radius: 8px; text-align: center; border-left: 3px solid #10b981;">
            <strong style="color: #065f46;">‚úÖ Interface Python native</strong><br>
            <span style="font-size: 0.9em; color: #666;">Int√©gration transparente</span>
        </div>

        <div style="background: #dbeafe; padding: 12px; border-radius: 8px; text-align: center; border-left: 3px solid #3b82f6;">
            <strong style="color: #1e40af;">‚úÖ Ex√©cution batch rapide</strong><br>
            <span style="font-size: 0.9em; color: #666;">Automatisation compl√®te</span>
        </div>

        <div style="background: #fef3c7; padding: 12px; border-radius: 8px; text-align: center; border-left: 3px solid #f59e0b;">
            <strong style="color: #92400e;">‚úÖ Acc√®s complet aux variables</strong><br>
            <span style="font-size: 0.9em; color: #666;">Toutes les sorties disponibles</span>
        </div>
    </div>

    <aside class="notes">
        Pour interfacer AquaCrop avec notre pipeline Python, on utilise AquaCrop-OSPy, un wrapper Python d√©velopp√© par l'√©quipe de l'Imperial College London. Il nous permet de configurer tous les param√®tres de culture et de sol, d'ex√©cuter AquaCrop en mode batch, et de r√©cup√©rer toutes les sorties journali√®res : biomasse, LAI, transpiration, etc. C'est l'outil id√©al pour automatiser et int√©grer AquaCrop dans notre cha√Æne de couplage.
    </aside>
</section>

<!-- SLIDE M4: Interface de Couplage Bidirectionnel -->
<section>
    <section data-background-color="#fbfbfb">
        <h6 style="color: #0B3D5B; border-bottom: 3px solid #6B8E23; padding-bottom: 10px; margin-bottom: 15px;">
            Interface de couplage bidirectionnel Richards ‚Üî AquaCrop
        </h6>

        <!-- Structure verticale : chaque image √† gauche avec caract√©ristiques √† droite -->
        
        <!-- Bloc 1 : Couplage Faible -->
        <div class="fragment fade-in" data-fragment-index="1" 
            style="display: grid; grid-template-columns: 1.2fr 1fr; gap: 20px; align-items: center; margin-bottom: 0px;">
            
            <!-- Image couplage faible (gauche) -->
            <div style="text-align: center;">
                <img src="assets/couplage_faible.png" 
                    style="width: 100%; max-height: 360px; object-fit: contain; box-shadow: 0 6px 20px rgba(0,0,0,0.12); border-radius: 10px;" 
                    alt="Couplage faible unidirectionnel">
                <p style="font-size: 0.45em; margin-top: 10px; color: #666; text-align: center; font-style: italic;">
                    <strong>Couplage faible (unidirectionnel)</strong><br>
                    Flux impos√© ‚Ä¢ Pas de r√©troaction intra-journali√®re
                </p>
            </div>
            
            <!-- Caract√©ristiques couplage faible (droite) -->
            <div style="background: #fef3c7; padding: 18px; margin-top: -50px; border-radius: 10px; border-left: 4px solid #f59e0b;">
                <h6 style="color: #92400e; margin-bottom: 12px; font-size: 0.8em;">‚ö° Caract√©ristiques</h6>
                <ul style="margin: 0; padding-left: 20px; line-height: 1.5; font-size: 0.58em;">
                    <li>AquaCrop impose T<sub>pot</sub></li>
                    <li>Richards observe et calcule moyennes</li>
                    <li>Pas de r√©troaction intra-journali√®re</li>
                    <li>Simple mais potentiellement instable</li>
                </ul>
            </div>
        </div>

        <!-- Bloc 2 : Couplage Fort -->
        <div class="fragment fade-in" data-fragment-index="2" 
            style="display: grid; grid-template-columns: 1.2fr 1fr; gap: 20px; align-items: center; margin-bottom: 15px;">
            
            <!-- Image couplage fort (gauche) -->
            <div style="text-align: center;">
                <img src="assets/couplage_fort.png"
                    style="width: 150%; max-height: 260px; object-fit: contain; box-shadow: 0 6px 20px rgba(0,0,0,0.12); border-radius: 10px;"
                    alt="Couplage fort bidirectionnel it√©ratif">
                <p style="font-size: 0.45em; margin-top: 10px; color: #666; text-align: center; font-style: italic;">
                    <strong>Couplage fort (bidirectionnel, it√©ratif)</strong><br>
                    It√©rations jusqu'√† convergence ‚Ä¢ Conservation de la masse
                </p>
            </div>
            
            <!-- Caract√©ristiques couplage fort (droite) -->
            <div style="background: #d1fae5; padding: 18px;  margin-top: -50px; border-radius: 10px; border-left: 4px solid #10b981;">
                <h6 style="color: #065f46; margin-bottom: 12px; font-size: 0.8em;">‚úì Caract√©ristiques</h6>
                <ul style="margin: 0; padding-left: 20px; line-height: 1.9; font-size: 0.58em;">
                    <li>It√©rations jusqu'√† convergence</li>
                    <li>Coh√©rence T<sub>r√©el</sub> ‚âà T<sub>pot</sub></li>
                    <li>Conservation de la masse garantie</li>
                    <li>Stable mais co√ªt calcul ‚Üë</li>
                </ul>
            </div>
        </div>

        <aside class="notes">
            Le couplage entre Richards et AquaCrop pose un vrai d√©fi d'√©chelles. √Ä gauche, le couplage faible : AquaCrop impose une demande en transpiration, Richards r√©pond, mais il n'y a pas de dialogue. √Ä droite, le couplage fort : on it√®re jusqu'√† convergence pour assurer la coh√©rence physique compl√®te. C'est plus co√ªteux mais beaucoup plus robuste et physiquement coh√©rent.
        </aside>
    </section>

    <!-- SLIDE M4v1: Op√©rateurs de Transformation (Verticale) -->
    <section data-background-color="#fbfbfb">
        <h6 style="color: #0B3D5B; border-bottom: 2px solid #6B8E23; padding-bottom: 8px; margin-bottom: 15px;">
            Op√©rateurs de transformation : Downscaling & Upscaling
        </h6>

        <!-- Probl√©matique des √©chelles -->
        <div class="fragment fade-in" data-fragment-index="1"
            style="background: #fef2f2; padding: 18px; border-radius: 10px; margin-bottom: 20px; border: 3px solid #e4dfdf;">
            <h6 style="color: #991b1b; margin-bottom: 12px; font-size: 0.8em;">‚ö†Ô∏è D√©fi: Incompatibilit√© des √©chelles</h6>
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; font-size: 0.52em;">
                <div style="background: white; padding: 10px; border-radius: 6px;">
                    <strong style="color: #ef4444;">Spatiale:</strong><br>
                    2D h√©t√©rog√®ne (Richards)<br>vs<br>1D homog√®ne (AquaCrop)
                </div>
                <div style="background: white; padding: 10px; border-radius: 6px;">
                    <strong style="color: #ef4444;">Temporelle:</strong><br>
                    $ \Delta_t \in [1, 60]$s (Richards)<br>vs<br>$\Delta_t = 86400$s (AquaCrop)
                </div>
                <div style="background: white; padding: 10px; border-radius: 6px;">
                    <strong style="color: #ef4444;">Variables:</strong><br>
                    $œà(r,z,t)$ (Richards)<br>vs<br>$\bar{Œ∏}_i(t)$ par couche (AquaCrop)
                </div>
            </div>
        </div>

        <!-- Introduction -->
        <p
            class="fragment fade-in" data-fragment-index="2"
            style="font-size: 0.6em; text-align: center; margin-bottom: 15px; color: #333; max-width: 900px; margin-left: auto; margin-right: auto; ">
            R√©concilier les √©chelles spatiales et temporelles n√©cessite des op√©rateurs math√©matiques rigoureux
        </p>


        <!-- Quatre transformations principales -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; font-size: 0.52em; margin-bottom: 15px;">
            
            <!-- 1. Irrigation -->
            <div class="fragment fade-in" data-fragment-index="2" 
                style="background: #dbeafe; padding: 12px; border-radius: 8px; border-left: 4px solid #3b82f6;">
                <h6 style="color: #1e40af; margin-bottom: 8px; font-size: 1.1em;">üíß 1. Irrigation : Global ‚Üí Local</h6>
                <div style="font-size: 1.15em; text-align: center; margin: 8px 0; line-height: 1.8;">
                    \[ q^{(n)} = \frac{I_{\text{net}}^{(n)} \cdot 10^{-3} \cdot A_p}{T_{\text{irr}}} \quad [\text{m}^3/\text{s}] \]
                </div>
                <p style="margin: 0; color: #666; font-size: 0.95em;">
                    Volume journalier (mm) ‚Üí Flux localis√© goutteur
                </p>
            </div>

            <!-- 2. Transpiration potentielle -->
            <div class="fragment fade-in" data-fragment-index="2" 
                style="background: #d1fae5; padding: 12px; border-radius: 8px; border-left: 4px solid #10b981;">
                <h6 style="color: #065f46; margin-bottom: 8px; font-size: 1.1em;">üå± 2. T<sub>pot</sub> : Demande ‚Üí Densit√© puits</h6>
                <div style="font-size: 1.1em; text-align: center; margin: 8px 0; line-height: 1.8;">
                    \[ S_{\text{pot}}(r,z,t) = \frac{T_{\text{pot}}^{(n)}}{L_{\text{rac}}} \cdot \rho(r,z) \cdot \phi(t) \]
                </div>
                <p style="margin: 0; color: #666; font-size: 0.95em;">
                    T<sub>pot</sub> journalier ‚Üí Extraction racinaire spatialis√©e
                </p>
            </div>

            <!-- 3. Upscaling teneur en eau -->
            <div class="fragment fade-in" data-fragment-index="2" 
                style="background: #fef3c7; padding: 12px; border-radius: 8px; border-left: 4px solid #f59e0b;">
                <h6 style="color: #92400e; margin-bottom: 8px; font-size: 1.1em;">‚¨ÜÔ∏è 3. Œ∏ effectif : 2D ‚Üí 1D par couche</h6>
                <div style="font-size: 1.1em; text-align: center; margin: 8px 0; line-height: 1.8;">
                    \[ \theta_i^{\text{eff}}(t) = \frac{2}{R_p^2 (z_i - z_{i-1})} \int_{z_{i-1}}^{z_i} \int_0^{R_p} \theta(r,z,t) \, r \, dr \, dz \]
                </div>
                <p style="margin: 0; color: #666; font-size: 0.95em;">
                    Champ continu Œ∏(r,z,t) ‚Üí Moyenne volumique par couche
                </p>
            </div>

            <!-- 4. Transpiration r√©elle -->
            <div class="fragment fade-in" data-fragment-index="2" 
                style="background: #fef2f2; padding: 12px; border-radius: 8px; border-left: 4px solid #ef4444;">
                <h6 style="color: #991b1b; margin-bottom: 8px; font-size: 1.1em;">üîÑ 4. T<sub>r√©el</sub> : Int√©gration locale</h6>
                <div style="font-size: 1.1em; text-align: center; margin: 8px 0; line-height: 1.8;">
                    \[ T_{\text{r√©el}}^{(n)} = \int_{t_n}^{t_{n+1}} \int_{\Omega_r} S_{\text{r√©el}}(r,z,t) \, dV \, dt \]
                </div>
                <p style="margin: 0; color: #666; font-size: 0.95em;">
                    Extraction 3D limit√©e par stress ‚Üí Volume total r√©el
                </p>
            </div>
        </div>

        <!-- Exigences th√©oriques -->
        <!-- <div class="fragment fade-up" data-fragment-index="5" 
            style="background: #f0f9ff; padding: 15px; border-radius: 10px; border: 2px solid #3b82f6; font-size: 0.55em;">
            <h6 style="color: #1e40af; margin-bottom: 10px; font-size: 1.05em;">‚öñÔ∏è Exigences de conservation</h6>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                <div>
                    <strong style="color: #0B3D5B;">Conservation de la masse:</strong>
                    <div style="font-size: 1.05em; margin-top: 5px;">
                        \[ \left|\Delta W_{\text{R}}^{\text{mm}} - \Delta W_{\text{AC}}^{\text{mm}}\right| < \epsilon \]
                    </div>
                </div>
                <div>
                    <strong style="color: #0B3D5B;">Coh√©rence spatiale:</strong>
                    <p style="margin: 5px 0 0 0; color: #666;">
                        Normalisation des op√©rateurs ‚¨áÔ∏è Downscaling et ‚¨ÜÔ∏è Upscaling
                    </p>
                </div>
            </div>
        </div> -->

        <aside class="notes">
            Pour r√©concilier les √©chelles, on utilise quatre transformations math√©matiques fondamentales. Premi√®rement, l'irrigation journali√®re en millim√®tres est convertie en flux volumique au goutteur. Deuxi√®mement, la transpiration potentielle journali√®re devient une densit√© de puits 3D pond√©r√©e par la distribution racinaire. Troisi√®mement, le champ continu 2D de teneur en eau est moyenn√© par couche pour AquaCrop. Quatri√®mement, l'extraction locale limit√©e par le stress hydrique est int√©gr√©e pour obtenir la transpiration r√©elle. Toutes ces transformations garantissent la conservation de la masse.
        </aside>
    </section>

</section>


<!-- SLIDE M5: Extraction Automatis√©e des Donn√©es -->
<section data-background-color="#fbfbfb">
    <h4 style="color: #0B3D5B; border-bottom: 3px solid #6B8E23; padding-bottom: 10px; margin-bottom: 30px;">
        Pipeline d'extraction et pr√©traitement des donn√©es
    </h4>

    <!-- Architecture du pipeline simplifi√© -->
    <div style="margin-bottom: 35px;">
        <svg viewBox="0 0 900 120" style="width: 85%; margin: 0 auto; display: block;">
            <!-- Bloc Acquisition -->
            <rect x="30" y="15" width="220" height="90" rx="10" fill="#dbeafe" stroke="#3b82f6" stroke-width="2.5"/>
            <text x="140" y="45" text-anchor="middle" font-size="16" font-weight="bold" fill="#1e40af">üì° Acquisition</text>
            <text x="140" y="68" text-anchor="middle" font-size="11" fill="#333">ERA5-Land (m√©t√©o)</text>
            <text x="140" y="88" text-anchor="middle" font-size="11" fill="#333">SoilGrids (sol)</text>
            
            <path d="M 250 60 L 315 60" stroke="#6B8E23" stroke-width="2.5" fill="none" marker-end="url(#arrow-pipe1)"/>
            
            <!-- Bloc Pr√©traitement -->
            <rect x="315" y="15" width="220" height="90" rx="10" fill="#fef3c7" stroke="#f59e0b" stroke-width="2.5"/>
            <text x="425" y="45" text-anchor="middle" font-size="16" font-weight="bold" fill="#92400e">üîß Pr√©traitement</text>
            <text x="425" y="68" text-anchor="middle" font-size="11" fill="#333">Fonctions p√©dotransfert</text>
            <text x="425" y="88" text-anchor="middle" font-size="11" fill="#333">Harmonisation</text>
            
            <path d="M 535 60 L 600 60" stroke="#6B8E23" stroke-width="2.5" fill="none" marker-end="url(#arrow-pipe2)"/>
            
            <!-- Bloc Param√®tres -->
            <rect x="600" y="15" width="220" height="90" rx="10" fill="#d1fae5" stroke="#10b981" stroke-width="2.5"/>
            <text x="710" y="45" text-anchor="middle" font-size="16" font-weight="bold" fill="#065f46">‚öôÔ∏è Param√®tres</text>
            <text x="710" y="68" text-anchor="middle" font-size="11" fill="#333">Richards (K, Œ∏)</text>
            <text x="710" y="88" text-anchor="middle" font-size="11" fill="#333">AquaCrop (sol, climat)</text>
            
            <defs>
                <marker id="arrow-pipe1" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#6B8E23" />
                </marker>
                <marker id="arrow-pipe2" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#6B8E23" />
                </marker>
            </defs>
        </svg>
    </div>

    <!-- D√©tails des sources et pr√©traitements -->
    <div 
         style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; font-size: 0.58em;">
        
        <!-- Sources de donn√©es -->
        <div style="background: #f0f9ff; padding: 18px; border-radius: 10px; border-left: 3px solid #3b82f6;">
            <h6 style="color: #1e40af; margin-bottom: 12px; font-size: 1.05em; text-align: center;">üì• Sources</h6>
            <div style="line-height: 1.9;">
                <p style="margin: 0 0 8px 0;"><strong>ERA5-Land</strong></p>
                <p style="margin: 0 0 12px 0; color: #666; font-size: 0.95em;">R√©-analyse climatique mondiale (9 km, horaire)</p>
                
                <p style="margin: 0 0 8px 0;"><strong>SoilGrids 2.0</strong></p>
                <p style="margin: 0; color: #666; font-size: 0.95em;">Propri√©t√©s p√©dologiques (250 m, 6 couches)</p>
            </div>
        </div>

        <!-- Pr√©traitements -->
        <div style="background: #fffbeb; padding: 18px; border-radius: 10px; border-left: 3px solid #f59e0b;">
            <h6 style="color: #92400e; margin-bottom: 12px; font-size: 1.05em; text-align: center;">ÔøΩ Pr√©traitements</h6>
            <ul style="margin: 0; padding-left: 20px; line-height: 1.9;">
                <li><strong>Interpolation</strong> spatio-temporelle</li>
                <li><strong>Fonctions p√©dotransfert</strong>
                    <ul style="margin-top: 4px; font-size: 0.95em; color: #666;">
                        <li>van Genuchten (Œ∏, K, œà)</li>
                        <li>Rosetta (texture ‚Üí hydraulique)</li>
                    </ul>
                </li>
                <li>Conversion unit√©s & formats</li>
            </ul>
        </div>

        <!-- Param√®tres g√©n√©r√©s -->
        <div style="background: #f0fdf4; padding: 18px; border-radius: 10px; border-left: 3px solid #10b981;">
            <h6 style="color: #065f46; margin-bottom: 12px; font-size: 1.05em; text-align: center;">üì§ Param√®tres g√©n√©r√©s</h6>
            <div style="line-height: 1.9;">
                <p style="margin: 0 0 8px 0;"><strong>Pour Richards :</strong></p>
                <p style="margin: 0 0 12px 0; color: #666; font-size: 0.95em;">K(œà), Œ∏(œà), Œ∏<sub>s</sub>, Œ∏<sub>r</sub>, Œ±, n</p>
                
                <p style="margin: 0 0 8px 0;"><strong>Pour AquaCrop :</strong></p>
                <p style="margin: 0; color: #666; font-size: 0.95em;">REW, TAW, Œ∏<sub>FC</sub>, Œ∏<sub>WP</sub>, ET‚ÇÄ</p>
            </div>
        </div>
    </div>

    <!-- Note sur l'automatisation -->
    <div
        class="fragment fade-up" data-fragment-index="1" 
         style="background: #f8f9fa; padding: 12px 20px; border-radius: 8px; margin-top: 25px; border-left: 3px solid #6B8E23; font-size: 0.6em; text-align: center;">
        <strong style="color: #0B3D5B;">‚úì Pipeline enti√®rement automatis√©</strong> ‚Äî 
        Reproductible pour n'importe quelle zone g√©ographique mondiale
    </div>

    <aside class="notes">
        Pour alimenter notre mod√®le, on a d√©velopp√© un pipeline d'extraction automatis√©. On part des donn√©es brutes ERA5-Land pour le climat et SoilGrids pour les propri√©t√©s du sol. L'√©tape cruciale est le pr√©traitement o√π on applique les fonctions de p√©dotransfert, notamment van Genuchten et Rosetta, pour transformer les donn√©es de texture en param√®tres hydrauliques utilisables par Richards. On g√©n√®re aussi tous les param√®tres n√©cessaires pour AquaCrop. Le tout est compl√®tement automatis√© et reproductible pour n'importe quelle zone du globe.
    </aside>
</section>

<!-- SLIDE M5: Extraction Automatis√©e des Donn√©es -->
<!-- <section data-background-color="#fbfbfb"> -->
    <!-- <h4 style="color: #0B3D5B; border-bottom: 3px solid #6B8E23; padding-bottom: 10px; margin-bottom: 20px;">
        Pipeline d'extraction automatis√©e ‚Äî ERA5-Land & SoilGrids
    </h4> -->

    <!-- Architecture du pipeline -->
    <!-- <div class="fragment fade-in" data-fragment-index="1" style="margin-bottom: 25px;">
        <svg viewBox="0 0 900 140" style="width: 90%; margin: 0 auto; display: block;"> -->
            <!-- Bloc Acquisition -->
            <!-- <rect x="20" y="20" width="240" height="100" rx="10" fill="#dbeafe" stroke="#3b82f6" stroke-width="3" />
            <text x="140" y="50" text-anchor="middle" font-size="17" font-weight="bold" fill="#1e40af">üì°
                Acquisition</text>
            <text x="140" y="72" text-anchor="middle" font-size="12" fill="#333">API CDS (ERA5-Land)</text>
            <text x="140" y="90" text-anchor="middle" font-size="12" fill="#333">API ISRIC (SoilGrids)</text>
            <text x="140" y="108" text-anchor="middle" font-size="12" fill="#333">G√©olocalisation auto</text>

            <path d="M 260 70 L 310 70" stroke="#6B8E23" stroke-width="3" fill="none" marker-end="url(#arrow-pipe1)" /> -->

            <!-- Bloc Pr√©traitement -->
            <!-- <rect x="310" y="20" width="240" height="100" rx="10" fill="#fef3c7" stroke="#f59e0b" stroke-width="3" />
            <text x="430" y="50" text-anchor="middle" font-size="17" font-weight="bold" fill="#92400e">üîß
                Pr√©traitement</text>
            <text x="430" y="72" text-anchor="middle" font-size="12" fill="#333">Interpolation spatiale</text>
            <text x="430" y="90" text-anchor="middle" font-size="12" fill="#333">Interpolation temporelle</text>
            <text x="430" y="108" text-anchor="middle" font-size="12" fill="#333">Harmonisation unit√©s</text>

            <path d="M 550 70 L 600 70" stroke="#6B8E23" stroke-width="3" fill="none" marker-end="url(#arrow-pipe2)" /> -->

            <!-- Bloc Transformation -->
            <!-- <rect x="600" y="20" width="240" height="100" rx="10" fill="#d1fae5" stroke="#10b981" stroke-width="3" />
            <text x="720" y="50" text-anchor="middle" font-size="17" font-weight="bold" fill="#065f46">‚öôÔ∏è
                Transformation</text>
            <text x="720" y="72" text-anchor="middle" font-size="12" fill="#333">Param√®tres Richards</text>
            <text x="720" y="90" text-anchor="middle" font-size="12" fill="#333">Param√®tres AquaCrop</text>
            <text x="720" y="108" text-anchor="middle" font-size="12" fill="#333">Format pipeline</text>

            <defs>
                <marker id="arrow-pipe1" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#6B8E23" />
                </marker>
                <marker id="arrow-pipe2" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#6B8E23" />
                </marker>
            </defs>
        </svg>
    </div> -->


<!-- </section> -->