<!-- ====================================================================
SECTION M√âTHODOLOGIE
12 slides couvrant: Architecture ‚Üí Solveur Richards ‚Üí Couplage ‚Üí Extraction
==================================================================== -->

<!-- SLIDE M0: Page de Transition "M√âTHODOLOGIE" -->
<section data-background-gradient="linear-gradient(135deg, #2C3E50 0%, #4A5568 50%, #718096 100%)">
    <div style="text-align: center; padding: 100px 0;">
        <div style="font-size: 5em; margin-top: 40px; filter: drop-shadow(0 4px 6px rgba(0,0,0,0.3));">‚öôÔ∏è</div>

        <h1 style="font-size: 3.5em; color: #FFFFFF; margin-bottom: 20px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">
            M√âTHODOLOGIE
        </h1>
        <p
            style="font-size: 1.4em; color: #E2E8F0; font-style: italic; margin-bottom: 40px; text-shadow: 1px 1px 2px rgba(0,0,0,0.2);">
            Du concept √† l'impl√©mentation
        </p>
    </div>

    <aside class="notes">
        Excellence Mr le Pr√©sident du Jury, Honorables membres du Jury, Passons maintenant √† la m√©thodologie o√π nous
        d√©crirons les diff√©rentes √©tapes de d√©veloppement de ce mod√®le coupl√©.
    </aside>
</section>

<!-- SLIDE M1: Architecture G√©n√©rale du Pipeline -->
<section data-background-color="#fbfbfb">
    <h4 style="color: #0B3D5B; border-bottom: 3px solid #6B8E23; padding-bottom: 10px; margin-bottom: 0px;">
        Architecture du pipeline de simulation
    </h4>

    <p style="font-size: 0.5em; text-align: center; margin: 10px auto; max-width: 900px; color: #333;">
        Un syst√®me modulaire int√©grant extraction de donn√©es, physique du sol et mod√®le de culture
    </p>

    <div class="fragment fade-in" data-fragment-index="1" style="text-align: center; margin-top: 0px;">
        <img src="assets/global_architecture.png"
            style="width: 68%; box-shadow: 0 6px 20px rgba(0,0,0,0.15); border-radius: 10px;"
            alt="Architecture globale du pipeline">
    </div>

    <!-- <div class="fragment fade-up" data-fragment-index="2" 
    style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-top: 5px; font-size: 0.4em;"> -->

    <!-- Colonne Entr√©es -->
    <!-- <div style="background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); 
               padding: 15px; border-radius: 8px; border-left: 4px solid #3b82f6;">
       <h6 style="color: #1e40af; margin-bottom: 10px; font-size: 0.8em;">üì• Entr√©es</h6>
       <ul style="margin: 0; padding-left: 20px; line-height: 1.6;">
           <li>Donn√©es ERA5-Land (m√©t√©o)</li>
           <li>SoilGrids (propri√©t√©s sol)</li>
           <li>Param√®tres culture</li>
           <li>Sc√©narios irrigation</li>
       </ul>
   </div> -->

    <!-- Colonne Modules -->
    <!-- <div style="background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%); 
               padding: 15px; border-radius: 8px; border-left: 4px solid #10b981;">
       <h6 style="color: #065f46; margin-bottom: 10px; font-size: 0.8em;">‚öôÔ∏è Modules</h6>
       <ul style="margin: 0; padding-left: 20px; line-height: 1.6;">
           <li><strong>Solveur Richards 2D</strong></li>
           <li><strong>AquaCrop-OSPy</strong></li>
           <li><strong>Interface couplage</strong></li>
           <li>Maillage adaptatif</li>
       </ul>
   </div> -->

    <!-- Colonne Sorties -->
    <!-- <div style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); 
               padding: 15px; border-radius: 8px; border-left: 4px solid #f59e0b;">
       <h6 style="color: #92400e; margin-bottom: 10px; font-size: 0.8em;">üì§ Sorties</h6>
       <ul style="margin: 0; padding-left: 20px; line-height: 1.6;">
           <li>Œ∏(r,z,t) ‚Äî Teneur en eau 2D</li>
           <li>Rendement et biomasse</li>
           <li>LAI et couverture</li>
           <li>Consommation d'eau</li>
       </ul>
   </div>
</div> -->

    <aside class="notes">
        Cette figure r√©sume l'architecture compl√®te de notre pipeline. Nous partons de donn√©es mondiales ERA5 et
        SoilGrids, qui sont pr√©trait√©es et inject√©es dans notre syst√®me de couplage bidirectionnel. Le c≈ìur du syst√®me
        est le solveur Richards 2D coupl√© avec AquaCrop. Les sorties nous donnent √† la fois l'√©tat hydrique complet du
        sol et les indicateurs agronomiques comme le rendement et le LAI.
    </aside>
</section>

<!-- SLIDE M2: Solveur Richards - Domaine et Conditions aux Limites -->
<section>
    <section data-background-color="#fbfbfb">
        <h4 style="color: #0B3D5B; border-bottom: 3px solid #6B8E23; padding-bottom: 10px; margin-bottom: 25px;">
            Solveur Richards 2D ‚Äî Domaine de simulation
        </h4>

        <div style="display: grid; grid-template-columns: 1.5fr 1fr; gap: 35px; align-items: start;">

            <!-- Colonne gauche: Image du domaine -->
            <div class="fragment fade-in" data-fragment-index="1">
                <img src="assets/domaine.png"
                    style="width: 120%; box-shadow: 0 6px 20px rgba(0,0,0,0.12); border-radius: 10px;"
                    alt="Domaine axisym√©trique Richards">
                <p style="font-size: 0.75em; margin-top: 12px; color: #666; text-align: center; font-style: italic;">
                    <strong>Figure:</strong> Domaine axisym√©trique $(r,z)$ avec conditions aux limites
                </p>
            </div>

            <!-- Colonne droite: Sp√©cifications techniques -->
            <div style="text-align: left; font-size: 0.55em;">

                <!-- G√©om√©trie -->
                <div class="fragment fade-up" data-fragment-index="1"
                    style="background: #dbeafe; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #3b82f6;">
                    <h6 style="color: #1e40af; margin-bottom: 10px; font-size: 1.15em;">üìê G√©om√©trie axisym√©trique</h6>
                    <ul style="margin: 0; padding-left: 20px; line-height: 1.8;">
                        <li><strong>Rayon:</strong> $R_{max} = 0.5 \text{‚Äì} 1.0 \ m$</li>
                        <li><strong>Profondeur:</strong> $Z_{max} = 1.0 \text{‚Äì} 1.5 \ m$</li>
                        <li><strong>Sym√©trie:</strong> Exploitation coordonn√©es cylindriques $(r,z)$</li>
                        <li><strong>Avantage:</strong> R√©duction 3D ‚Üí 2D</li>
                    </ul>
                </div>

                <!-- Conditions aux limites -->
                <div class="fragment fade-up" data-fragment-index="1"
                    style="background: #fef3c7; padding: 15px; border-radius: 8px; border-left: 4px solid #f59e0b;">
                    <h6 style="color: #92400e; margin-bottom: 10px; font-size: 1.15em;">üîó Conditions aux limites</h6>
                    <ul style="margin: 0; padding-left: 20px; line-height: 1.8;">
                        <li>$\Gamma_{\text{surf}}^{\text{irr}} :$ Flux d‚Äôirrigation $q_{irr}(t)$</li>
                        <li>$\Gamma_{\text{surf}}^{\text{atm}} :$ Flux atmosph√©rique $(P - ET)$</li>
                        <li>$\Gamma_{\text{axe}} :$ Sym√©trie $(\partial \psi / \partial r = 0)$</li>
                        <li>$\Gamma_{\text{lat}}, \ \Gamma_{\text{fond}} :$ Drainage libre ou flux nul</li>
                    </ul>
                </div>

            </div>
        </div>

        <aside class="notes">
            Pour r√©soudre l'√©quation de Richards, nous utilisons un domaine axisym√©trique en coordonn√©es (r,z).
            Les conditions aux limites sont d√©terminantes : en surface, on impose le flux d'irrigation
            localis√© (qui peut-√™tre de type Dirichlet ou Neumann si les √©changes atmosph√©riques sont prises en compte).
            Sur l'axe, la condition de sym√©trie. Et sur les bords lat√©raux et le fond, on peut avoir du drainage libre
            selon la configuration.
        </aside>
    </section>


    <!-- SLIDE M2v2: Maillage Adaptatif (Verticale avec Vid√©o) -->
    <section data-background-color="#fbfbfb">
        <h5 style="color: #0B3D5B; border-bottom: 2px solid #6B8E23; padding-bottom: 8px; margin-bottom: 20px;">
            Maillage adaptatif pour capture des gradients
        </h5>

        <!-- Vid√©o animation -->
        <div class="fragment fade-in" data-fragment-index="1" style="text-align: center; margin-bottom: 25px;">
            <video width="80%" controls autoplay loop muted
                style="border-radius: 10px; box-shadow: 0 6px 20px rgba(0,0,0,0.15);">
                <source src="assets/animations/mesh_comparison_animation.mp4" type="video/mp4">
                Votre navigateur ne supporte pas la vid√©o HTML5.
            </video>
            <p style="font-size: 0.55em; margin-top: 12px; color: #666; font-style: italic;">
                <strong>Animation:</strong> Comparaison maillage uniforme vs adaptatif
            </p>
        </div>

        <!-- Comparaison texte -->
        <div class="fragment fade-up" data-fragment-index="1"
            style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px; font-size: 0.52em;">

            <!-- Maillage uniforme -->
            <div style="padding: 18px; border-radius: 8px;">
                <h6 style="color: #991b1b; margin-bottom: 10px; font-size: 0.9em;">‚ùå Maillage uniforme</h6>
                <ul style="margin: 0; padding-left: 20px; line-height: 1.5;">
                    <li>Simple √† g√©n√©rer</li>
                    <li>~50,000 √©l√©ments</li>
                    <li>Gradients mal captur√©s</li>
                    <li>Pr√©cision limit√©e</li>
                    <li>Co√ªt calcul √©lev√©</li>
                </ul>
            </div>

            <!-- Maillage adaptatif -->
            <div style="padding: 18px; border-radius: 8px;">
                <h6 style="color: #065f46; margin-bottom: 10px; font-size: 0.9em;">‚úÖ Maillage adaptatif</h6>
                <ul style="margin: 0; padding-left: 20px; line-height: 1.5;">
                    <li>Raffinement local pr√®s goutteur</li>
                    <li>~15,000 √©l√©ments</li>
                    <li>Gradients bien captur√©s</li>
                    <li><strong>Pr√©cision 10√ó meilleure</strong></li>
                    <li><strong>Co√ªt r√©duit de 60%</strong></li>
                </ul>
            </div>
            <!-- </div> -->

            <!-- Image statique compl√©mentaire -->
            <!-- <div class="fragment fade-in" data-fragment-index="3" style="text-align: center; margin-top: 20px;">
      <img src="assets/maillage.png" 
          style="width: 55%; box-shadow: 0 4px 15px rgba(0,0,0,0.1); border-radius: 8px;" 
          alt="Zoom maillage adaptatif">
      <p style="font-size: 0.5em; margin-top: 8px; color: #666; font-style: italic;">
          <strong>Zoom:</strong> Raffinement intense dans la zone du bulbe d'humectation
      </p>
  </div> -->

            <aside class="notes">
                Le choix du maillage est crucial. Cette animation montre la diff√©rence entre un maillage uniforme et
                notre maillage adaptatif. On raffine fortement la zone proche du goutteur o√π les gradients de pression
                sont tr√®s forts. R√©sultat : on divise le nombre d'√©l√©ments par 3 tout en augmentant consid√©rablement la
                pr√©cision. C'est essentiel pour capturer correctement la formation du bulbe d'humectation.
            </aside>
    </section>


    <!-- SLIDE M2v3: Discr√©tisation FEM + Algorithme (Verticale) -->
    <section data-background-color="#fbfbfb">
        <h5 style="color: #0B3D5B; border-bottom: 3px solid #6B8E23; padding-bottom: 10px; margin-bottom: 40px;">
            Discr√©tisation FEM & Strat√©gie de r√©solution
        </h5>

        <!-- Layout 2 colonnes : FEM √† gauche, Algorithme √† droite -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px; font-size: 0.55em;">

            <!-- COLONNE GAUCHE: Discr√©tisation FEM -->
            <div class="fragment fade-in" data-fragment-index="1"
                style="background: #eff6ff; padding: 18px; border-radius: 10px; border: 2px solid #3b82f6;">
                <h6 style="color: #1e3a8a; margin: 0 0 12px 0; font-size: 1.15em; text-align: center;">
                    üî∂ Discr√©tisation FEM (Galerkin P1)
                </h6>
                <div style="font-size: 1.1em; text-align: center; line-height: 1.9; margin-bottom: 12px;">
                    \[ \psi_h(r,z,t) = \sum_{j=1}^N \psi_j(t) \phi_j(r,z) \]
                </div>
                <div
                    style="font-size: 1.15em; text-align: center; line-height: 2.2; background: white; padding: 12px; border-radius: 6px; margin-bottom: 12px;">
                    \[
                    \mathbf{M}(\boldsymbol{\psi}) \frac{d\boldsymbol{\psi}}{dt}
                    + \mathbf{A}(\boldsymbol{\psi}) \boldsymbol{\psi}
                    + \mathbf{g}(\boldsymbol{\psi})
                    = \mathbf{f} + \mathbf{s}
                    \]
                </div>
                <p style="margin: 0; font-size: 0.95em; color: #475569; text-align: center; font-style: italic;">
                    Syst√®me EDO matriciel non-lin√©aire
                </p>

                <div class="fragment fade-up" data-fragment-index="1"
                    style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; font-size: 0.78em;">

                    <div style="padding: 12px; border-radius: 6px;">
                        <strong style="color: #1e40af;">$M(\psi)$:</strong> Matrice de masse<br>
                        <span style="font-size: 0.95em; color: #666;">Terme capacitif $C(\psi) \frac{\partial
                            \psi}{\partial
                            t}$</span>
                    </div>

                    <div style="padding: 12px; border-radius: 6px;">
                        <strong style="color: #92400e;">$A(\psi)$:</strong> Matrice de rigidit√©<br>
                        <span style="font-size: 0.95em; color: #666;">Terme diffusif $K(\psi) \nabla \psi$</span>
                    </div>

                    <div style="padding: 12px; border-radius: 6px;">
                        <strong style="color: #065f46;">$g(\psi)$:</strong> Vecteur gravitaire<br>
                        <span style="font-size: 0.95em; color: #666;">Drainage $K(\psi) \frac{\partial}{\partial
                            z}$</span>
                    </div>

                    <div style="padding: 12px; border-radius: 6px;">
                        <strong style="color: #991b1b;">$f, s(\psi)$:</strong> Termes sources<br>
                        <span style="font-size: 0.95em; color: #666;">Flux de bord + extraction racinaire</span>
                    </div>
                </div>
            </div>

            <!-- COLONNE DROITE: Algorithme de R√©solution -->
            <div class="fragment fade-in" data-fragment-index="1">
                <div
                    style="background: #fef3c7; padding: 18px; border-radius: 10px; border: 2px solid #f59e0b; height: 92%;">
                    <h6 style="color: #92400e; margin: 0 0 12px 0; font-size: 1.15em; text-align: center;">
                        ‚ö° Strat√©gie de r√©solution
                    </h6>

                    <!-- Sch√©ma temporel -->
                    <div style="background: white; padding: 12px; border-radius: 6px; margin-bottom: 12px;">
                        <p style="margin: 0 0 8px 0; font-size: 1.0em; color: #991b1b; text-align: center;">
                            <strong>Euler implicite (A-stable)</strong>
                        </p>
                        <div style="font-size: 1.05em; text-align: center; line-height: 1.9;">
                            \[
                            \mathbf{R}(\boldsymbol{\psi}^{n+1}) = \frac{\mathbf{M}}{\Delta t}(\boldsymbol{\psi}^{n+1} -
                            \boldsymbol{\psi}^n) + \mathbf{A}\boldsymbol{\psi}^{n+1} + \mathbf{g} = \mathbf{0}
                            \]
                        </div>
                    </div>

                    <!-- Lin√©arisation hybride -->
                    <div style="background: #fff7ed; padding: 22px; border-radius: 6px;">
                        <p
                            style="margin: 0 0 10px 0; font-size: 1.05em; color: #78350f; font-weight: 600; text-align: center;">
                            Hybride Picard-Newton
                        </p>
                        <ol style="margin: 0; padding-left: 20px; line-height: 1.8; font-size: 1.0em; color: #451a03;">
                            <li><strong>Phase Picard</strong> : 2-5 it√©rations initiales (robustesse)</li>
                            <li><strong>Phase Newton</strong> : Jacobien complet ‚Üí convergence quadratique</li>
                            <li><strong>Œît adaptatif</strong> : Ajustement dynamique selon convergence</li>
                        </ol>
                    </div>

                    <!-- Ic√¥nes r√©sum√© -->
                    <!-- <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-top: 15px; font-size: 0.95em; text-align: center;">
                   <div style="background: #dbeafe; padding: 8px; border-radius: 4px;">
                       <div style="font-size: 1.5em;">üîÑ</div>
                       <div style="color: #1e40af; font-weight: 600;">Picard</div>
                   </div>
                   <div style="background: #d1fae5; padding: 8px; border-radius: 4px;">
                       <div style="font-size: 1.5em;">‚ö°</div>
                       <div style="color: #065f46; font-weight: 600;">Newton</div>
                   </div>
                   <div style="background: #fef3c7; padding: 8px; border-radius: 4px;">
                       <div style="font-size: 1.5em;">‚è±Ô∏è</div>
                       <div style="color: #92400e; font-weight: 600;">Œît adapt.</div>
                   </div>
               </div> -->
                </div>
            </div>
        </div>

        <aside class="notes">
            <!-- Discr√©tisation FEM Galerkin P1 transformant l'EDP en syst√®me matriciel, strat√©gie hybride Picard-Newton avec pas de temps adaptatif. -->

            On discr√©tise l'espace avec des √©l√©ments finis lin√©aires de Galerkin. Cela transforme la forme
            variationnelle de notre EDP en un syst√®me d'EDO matriciel. On retrouve la matrice
            de masse M qui repr√©sente l'accumulation, la matrice de rigidit√© A pour la diffusion, et les vecteurs pour
            la gravit√© et les sources.

            Pour la r√©solution temporelle, on utilise un sch√©ma d'Euler implicite, qui est A-stable. La non-lin√©arit√©
            est g√©r√©e via une approche hybride : on commence par quelques it√©rations de Picard pour assurer la
            robustesse,
            puis on bascule vers Newton pour une convergence rapide. Le pas de temps est ajust√© dynamiquement en
            fonction
            de la convergence.
        </aside>
    </section>


</section>

<!-- SLIDE M4: Interface de Couplage Bidirectionnel -->
<section>
    <section data-background-color="#fbfbfb">
        <h6 style="color: #0B3D5B; border-bottom: 3px solid #6B8E23; padding-bottom: 10px; margin-bottom: 15px;">
            Interface de couplage bidirectionnel Richards ‚Üî AquaCrop
        </h6>

        <!-- Structure verticale : chaque image √† gauche avec caract√©ristiques √† droite -->

        <!-- Bloc 1 : Couplage Faible -->
        <div class="fragment fade-in" data-fragment-index="1"
            style="display: grid; grid-template-columns: 1.2fr 1fr; gap: 20px; align-items: center; margin-bottom: 0px;">

            <!-- Image couplage faible (gauche) -->
            <div style="text-align: center;">
                <img src="assets/couplage_faible.png"
                    style="width: 100%; max-height: 360px; object-fit: contain; box-shadow: 0 6px 20px rgba(0,0,0,0.12); border-radius: 10px;"
                    alt="Couplage faible unidirectionnel">
                <p style="font-size: 0.45em; margin-top: 10px; color: #666; text-align: center; font-style: italic;">
                    <strong>Couplage faible (bidirectionnel, s√©quentiel)</strong><br>
                    Flux impos√© ‚Ä¢ Pas de r√©troaction intra-journali√®re
                </p>
            </div>

            <!-- Caract√©ristiques couplage faible (droite) -->
            <div
                style="background: #fef3c7; padding: 18px; margin-top: -50px; border-radius: 10px; border-left: 4px solid #f59e0b;">
                <h6 style="color: #92400e; margin-bottom: 12px; font-size: 0.8em;">‚ö° Caract√©ristiques</h6>
                <ul style="margin: 0; padding-left: 20px; line-height: 1.5; font-size: 0.58em;">
                    <li>AquaCrop impose T<sub>pot</sub></li>
                    <li>Richards observe et calcule moyennes</li>
                    <li>Pas de r√©troaction intra-journali√®re</li>
                    <li>Simple mais potentiellement instable</li>
                </ul>
            </div>
        </div>

        <!-- Bloc 2 : Couplage Fort -->
        <div class="fragment fade-in" data-fragment-index="2"
            style="display: grid; grid-template-columns: 1.2fr 1fr; gap: 20px; align-items: center; margin-bottom: 15px;">

            <!-- Image couplage fort (gauche) -->
            <div style="text-align: center;">
                <img src="assets/couplage_fort.png"
                    style="width: 150%; max-height: 260px; object-fit: contain; box-shadow: 0 6px 20px rgba(0,0,0,0.12); border-radius: 10px;"
                    alt="Couplage fort bidirectionnel it√©ratif">
                <p style="font-size: 0.45em; margin-top: 10px; color: #666; text-align: center; font-style: italic;">
                    <strong>Couplage fort (bidirectionnel, it√©ratif)</strong><br>
                    It√©rations jusqu'√† convergence ‚Ä¢ Conservation de la masse
                </p>
            </div>

            <!-- Caract√©ristiques couplage fort (droite) -->
            <div
                style="background: #d1fae5; padding: 18px;  margin-top: -50px; border-radius: 10px; border-left: 4px solid #10b981;">
                <h6 style="color: #065f46; margin-bottom: 12px; font-size: 0.8em;">‚úì Caract√©ristiques</h6>
                <ul style="margin: 0; padding-left: 20px; line-height: 1.9; font-size: 0.58em;">
                    <li>It√©rations jusqu'√† convergence</li>
                    <li>Coh√©rence T<sub>r√©el</sub> ‚âà T<sub>pot</sub></li>
                    <li>Conservation de la masse garantie</li>
                    <li>Stable mais co√ªt calcul ‚Üë</li>
                </ul>
            </div>
        </div>

        <aside class="notes">

            Nous avons distingu√© au cours de notre d√©veloppement deux mani√®res de faire dialoguer AquaCrop et Richards.
            <br> <br>
            En haut, le couplage faible : AquaCrop impose la transpiration, et Richards simule la r√©ponse du sol sans
            r√©troaction √† l'int√©rieur du pas de simulation.
            C‚Äôest simple, mais physiquement limit√©.
            <br> <br>
            En bas, le couplage fort : les deux mod√®les √©changent de mani√®re it√©rative, jusqu‚Äô√† ce que la transpiration
            demand√©e et
            celle calcul√©e convergent.
            <br> <br>
            Cette approche garantit la coh√©rence et la conservation de la masse, au prix d‚Äôun co√ªt de calcul un peu plus
            √©lev√© .
            <br><br>
            <!-- Le couplage entre Richards et AquaCrop pose un vrai d√©fi d'√©chelles. √Ä gauche, le couplage faible : AquaCrop
       impose une demande en transpiration, Richards r√©pond, mais il n'y a pas de dialogue. √Ä droite, le couplage
       fort : on it√®re jusqu'√† convergence pour assurer la coh√©rence physique compl√®te. C'est plus co√ªteux mais
       beaucoup plus robuste et physiquement coh√©rent. -->
        </aside>
    </section>

    <!-- SLIDE M4v1: Op√©rateurs de Transformation (Verticale) -->
    <section data-background-color="#fbfbfb">
        <h6 style="color: #0B3D5B; border-bottom: 2px solid #6B8E23; padding-bottom: 8px; margin-bottom: 15px;">
            Op√©rateurs de transformation : Downscaling & Upscaling
        </h6>

        <!-- Probl√©matique des √©chelles -->
        <div class="fragment fade-in" data-fragment-index="1"
            style="background: #fef2f2; padding: 18px; border-radius: 10px; margin-bottom: 20px; border: 3px solid #e4dfdf;">
            <h6 style="color: #991b1b; margin-bottom: 12px; font-size: 0.8em;">‚ö†Ô∏è D√©fi: Incompatibilit√© des √©chelles
            </h6>
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; font-size: 0.52em;">
                <div style="background: white; padding: 10px; border-radius: 6px;">
                    <strong style="color: #ef4444;">Spatiale:</strong><br>
                    2D h√©t√©rog√®ne (Richards)<br>vs<br>1D homog√®ne (AquaCrop)
                </div>
                <div style="background: white; padding: 10px; border-radius: 6px;">
                    <strong style="color: #ef4444;">Temporelle:</strong><br>
                    $ \Delta_t \in [1, 60]$s (Richards)<br>vs<br>$\Delta_t = 86400$s (AquaCrop)
                </div>
                <div style="background: white; padding: 10px; border-radius: 6px;">
                    <strong style="color: #ef4444;">Variables:</strong><br>
                    $œà(r,z,t)$ (Richards)<br>vs<br>$\bar{Œ∏}_i(t)$ par couche (AquaCrop)
                </div>
            </div>
        </div>

        <!-- Introduction -->
        <p class="fragment fade-in" data-fragment-index="2"
            style="font-size: 0.6em; text-align: center; margin-bottom: 15px; color: #333; max-width: 900px; margin-left: auto; margin-right: auto; ">
            R√©concilier les √©chelles spatiales et temporelles n√©cessite des op√©rateurs math√©matiques rigoureux
        </p>


        <!-- Quatre transformations principales -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; font-size: 0.52em; margin-bottom: 15px;">

            <!-- 1. Irrigation -->
            <div class="fragment fade-in" data-fragment-index="3"
                style="background: #dbeafe; padding: 12px; border-radius: 8px; border-left: 4px solid #3b82f6;">
                <h6 style="color: #1e40af; margin-bottom: 8px; font-size: 1.1em;">üíß 1. Irrigation : Global ‚Üí Local</h6>
                <div style="font-size: 1.15em; text-align: center; margin: 8px 0; line-height: 1.8;">
                    \[ q^{(n)} = \frac{I_{\text{net}}^{(n)} \cdot 10^{-3} \cdot A_p}{T_{\text{irr}}} \quad
                    [\text{m}^3/\text{s}] \]
                </div>
                <p style="margin: 0; color: #666; font-size: 0.95em;">
                    Volume journalier (mm) ‚Üí Flux localis√© goutteur
                </p>
            </div>

            <!-- 2. Transpiration potentielle -->
            <div class="fragment fade-in" data-fragment-index="4"
                style="background: #d1fae5; padding: 12px; border-radius: 8px; border-left: 4px solid #10b981;">
                <h6 style="color: #065f46; margin-bottom: 8px; font-size: 1.1em;">üå± 2. T<sub>pot</sub> : Demande ‚Üí
                    Densit√© puits</h6>
                <div style="font-size: 1.1em; text-align: center; margin: 8px 0; line-height: 1.8;">
                    \[ S_{\text{pot}}(r,z,t) = \frac{T_{\text{pot}}^{(n)}}{L_{\text{rac}}} \cdot \rho(r,z) \cdot \phi(t)
                    \]
                </div>
                <p style="margin: 0; color: #666; font-size: 0.95em;">
                    T<sub>pot</sub> journalier ‚Üí Extraction racinaire spatialis√©e
                </p>
            </div>

            <!-- 3. Upscaling teneur en eau -->
            <div class="fragment fade-in" data-fragment-index="5"
                style="background: #fef3c7; padding: 12px; border-radius: 8px; border-left: 4px solid #f59e0b;">
                <h6 style="color: #92400e; margin-bottom: 8px; font-size: 1.1em;">‚¨ÜÔ∏è 3. Œ∏ effectif : 2D ‚Üí 1D par couche
                </h6>
                <div style="font-size: 1.1em; text-align: center; margin: 8px 0; line-height: 1.8;">
                    \[ \theta_i^{\text{eff}}(t) = \frac{2}{R_p^2 (z_i - z_{i-1})} \int_{z_{i-1}}^{z_i} \int_0^{R_p}
                    \theta(r,z,t) \, r \, dr \, dz \]
                </div>
                <p style="margin: 0; color: #666; font-size: 0.95em;">
                    Champ continu Œ∏(r,z,t) ‚Üí Moyenne volumique par couche
                </p>
            </div>

            <!-- 4. Transpiration r√©elle -->
            <div class="fragment fade-in" data-fragment-index="6"
                style="background: #fef2f2; padding: 12px; border-radius: 8px; border-left: 4px solid #ef4444;">
                <h6 style="color: #991b1b; margin-bottom: 8px; font-size: 1.1em;">üîÑ 4. T<sub>r√©el</sub> : Int√©gration
                    locale</h6>
                <div style="font-size: 1.1em; text-align: center; margin: 8px 0; line-height: 1.8;">
                    \[ T_{\text{r√©el}}^{(n)} = \int_{t_n}^{t_{n+1}} \int_{\Omega_r} S_{\text{r√©el}}(r,z,t) \, dV \, dt
                    \]
                </div>
                <p style="margin: 0; color: #666; font-size: 0.95em;">
                    Extraction 3D limit√©e par stress ‚Üí Volume total r√©el
                </p>
            </div>
        </div>

        <!-- Exigences th√©oriques -->
        <!-- <div class="fragment fade-up" data-fragment-index="5" 
       style="background: #f0f9ff; padding: 15px; border-radius: 10px; border: 2px solid #3b82f6; font-size: 0.55em;">
       <h6 style="color: #1e40af; margin-bottom: 10px; font-size: 1.05em;">‚öñÔ∏è Exigences de conservation</h6>
       <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
           <div>
               <strong style="color: #0B3D5B;">Conservation de la masse:</strong>
               <div style="font-size: 1.05em; margin-top: 5px;">
                   \[ \left|\Delta W_{\text{R}}^{\text{mm}} - \Delta W_{\text{AC}}^{\text{mm}}\right| < \epsilon \]
               </div>
           </div>
           <div>
               <strong style="color: #0B3D5B;">Coh√©rence spatiale:</strong>
               <p style="margin: 5px 0 0 0; color: #666;">
                   Normalisation des op√©rateurs ‚¨áÔ∏è Downscaling et ‚¨ÜÔ∏è Upscaling
               </p>
           </div>
       </div>
   </div> -->

        <aside class="notes">

            <br> <br>
            Pour r√©concilier ces √©chelles, nous avons d√©velopp√© quatre op√©rateurs de transformation math√©matiques :
            <br> <br>
            Premi√®rement,
            l'irrigation journali√®re en millim√®tres est convertie en flux volumique au goutteur.
            <br> <br>
            Deuxi√®mement, la
            transpiration potentielle journali√®re devient une densit√© de puits 3D pond√©r√©e par la distribution
            racinaire.
            <br> <br>
            Troisi√®mement, le champ continu 2D de teneur en eau est moyenn√© par couche pour AquaCrop.
            <br> <br>
            Quatri√®mement, l'extraction locale limit√©e par le stress hydrique est int√©gr√©e pour obtenir la transpiration
            r√©elle. Toutes ces transformations permettent de garantir la conservation de la masse.
            <br> <br>
        </aside>
    </section>

</section>


<!-- SLIDE M5: Extraction Automatis√©e des Donn√©es -->
<section data-background-color="#fbfbfb">
    <h4 style="color: #0B3D5B; border-bottom: 3px solid #6B8E23; padding-bottom: 10px; margin-bottom: 30px;">
        Pipeline d'extraction et pr√©traitement des donn√©es
    </h4>

    <!-- Architecture du pipeline simplifi√© -->
    <div style="margin-bottom: 35px;">
        <svg viewBox="0 0 900 120" style="width: 85%; margin: 0 auto; display: block;">
            <!-- Bloc Acquisition -->
            <rect x="30" y="15" width="220" height="90" rx="10" fill="#dbeafe" stroke="#3b82f6" stroke-width="2.5" />
            <text x="140" y="45" text-anchor="middle" font-size="16" font-weight="bold" fill="#1e40af">üì°
                Acquisition</text>
            <text x="140" y="68" text-anchor="middle" font-size="11" fill="#333">ERA5-Land (m√©t√©o)</text>
            <text x="140" y="88" text-anchor="middle" font-size="11" fill="#333">SoilGrids (sol)</text>

            <path d="M 250 60 L 315 60" stroke="#6B8E23" stroke-width="2.5" fill="none"
                marker-end="url(#arrow-pipe1)" />

            <!-- Bloc Pr√©traitement -->
            <rect x="315" y="15" width="220" height="90" rx="10" fill="#fef3c7" stroke="#f59e0b" stroke-width="2.5" />
            <text x="425" y="45" text-anchor="middle" font-size="16" font-weight="bold" fill="#92400e">üîß
                Pr√©traitement</text>
            <text x="425" y="68" text-anchor="middle" font-size="11" fill="#333">Fonctions p√©dotransfert</text>
            <text x="425" y="88" text-anchor="middle" font-size="11" fill="#333">Harmonisation</text>

            <path d="M 535 60 L 600 60" stroke="#6B8E23" stroke-width="2.5" fill="none"
                marker-end="url(#arrow-pipe2)" />

            <!-- Bloc Param√®tres -->
            <rect x="600" y="15" width="220" height="90" rx="10" fill="#d1fae5" stroke="#10b981" stroke-width="2.5" />
            <text x="710" y="45" text-anchor="middle" font-size="16" font-weight="bold" fill="#065f46">‚öôÔ∏è
                Param√®tres</text>
            <text x="710" y="68" text-anchor="middle" font-size="11" fill="#333">Richards (K, Œ∏)</text>
            <text x="710" y="88" text-anchor="middle" font-size="11" fill="#333">AquaCrop (sol, climat)</text>

            <defs>
                <marker id="arrow-pipe1" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#6B8E23" />
                </marker>
                <marker id="arrow-pipe2" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#6B8E23" />
                </marker>
            </defs>
        </svg>
    </div>

    <!-- D√©tails des sources et pr√©traitements -->
    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; font-size: 0.58em;">

        <!-- Sources de donn√©es -->
        <div style="background: #f0f9ff; padding: 18px; border-radius: 10px; border-left: 3px solid #3b82f6;">
            <h6 style="color: #1e40af; margin-bottom: 12px; font-size: 1.05em; text-align: center;">üì• Sources</h6>
            <div style="line-height: 1.9;">
                <p style="margin: 0 0 8px 0;"><strong>ERA5-Land</strong></p>
                <p style="margin: 0 0 12px 0; color: #666; font-size: 0.95em;">R√©-analyse climatique mondiale (9 km,
                    horaire)</p>

                <p style="margin: 0 0 8px 0;"><strong>SoilGrids 2.0</strong></p>
                <p style="margin: 0; color: #666; font-size: 0.95em;">Propri√©t√©s p√©dologiques (250 m, 6 couches)</p>
            </div>
        </div>

        <!-- Pr√©traitements -->
        <div style="background: #fffbeb; padding: 18px; border-radius: 10px; border-left: 3px solid #f59e0b;">
            <h6 style="color: #92400e; margin-bottom: 12px; font-size: 1.05em; text-align: center;">ÔøΩ Pr√©traitements
            </h6>
            <ul style="margin: 0; padding-left: 20px; line-height: 1.9;">
                <li><strong>Interpolation</strong> spatio-temporelle</li>
                <li><strong>Fonctions p√©dotransfert</strong>
                    <ul style="margin-top: 4px; font-size: 0.95em; color: #666;">
                        <li>van Genuchten (Œ∏, K, œà)</li>
                        <li>Rosetta (texture ‚Üí hydraulique)</li>
                    </ul>
                </li>
                <li>Conversion unit√©s & formats</li>
            </ul>
        </div>

        <!-- Param√®tres g√©n√©r√©s -->
        <div style="background: #f0fdf4; padding: 18px; border-radius: 10px; border-left: 3px solid #10b981;">
            <h6 style="color: #065f46; margin-bottom: 12px; font-size: 1.05em; text-align: center;">üì§ Param√®tres
                g√©n√©r√©s</h6>
            <div style="line-height: 1.9;">
                <p style="margin: 0 0 8px 0;"><strong>Pour Richards :</strong></p>
                <p style="margin: 0 0 12px 0; color: #666; font-size: 0.95em;">K(œà), Œ∏(œà), Œ∏<sub>s</sub>, Œ∏<sub>r</sub>,
                    Œ±, n</p>

                <p style="margin: 0 0 8px 0;"><strong>Pour AquaCrop :</strong></p>
                <p style="margin: 0; color: #666; font-size: 0.95em;">REW, TAW, Œ∏<sub>FC</sub>, Œ∏<sub>WP</sub>, ET‚ÇÄ</p>
            </div>
        </div>
    </div>

    <!-- Note sur l'automatisation -->
    <div class="fragment fade-up" data-fragment-index="1"
        style="background: #f8f9fa; padding: 12px 20px; border-radius: 8px; margin-top: 25px; border-left: 3px solid #6B8E23; font-size: 0.6em; text-align: center;">
        <strong style="color: #0B3D5B;">‚úì Pipeline enti√®rement automatis√©</strong> ‚Äî
        Reproductible pour n'importe quelle zone g√©ographique mondiale
    </div>

    <aside class="notes">
        Pipeline automatis√© : ERA5-Land pour climat, SoilGrids pour sol, fonctions p√©dotransfert (van Genuchten,
        Rosetta) pour param√®tres hydrauliques. Reproductible mondialement.
    </aside>
</section>